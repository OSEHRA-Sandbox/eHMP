{
    "//notice": "This file is automatically generated. Any edits will be overwritten.",
    "maxSockets": <%= node['activity_handler']['service_config']['max_sockets'] %>,
    "parallelPublish": 20,
    "beanstalk": {
        "repoUniversal": {
            "priority": <%= @vxsync['vxsync']['beanstalk_priority'] %>,
            "delay": <%= @vxsync['vxsync']['beanstalk_delay'] %>,
            "ttr": <%= @vxsync['vxsync']['beanstalk_ttr'] %>,
            "timeout": <%= @vxsync['vxsync']['beanstalk_timeout'] %>,
            "initMillis": <%= @vxsync['vxsync']['beanstalk_init_millis'] %>,
            "maxMillis": <%= @vxsync['vxsync']['beanstalk_max_millis'] %>,
            "incMillis": <%= @vxsync['vxsync']['beanstalk_inc_millis'] %>
        },
        "repoDefaults": {
            "host": "<%= @vxsync['ipaddress'] %>",
            "port": <%= @beanstalk_config['port'] %>,
            "tubename": "<%= @vxsync['beanstalk']['tube_name'] %>",
            "tubePrefix": "<%= @vxsync['beanstalk']['tube_prefix'] %>",
            "jobTypeForTube": <%= @vxsync['beanstalk']['job_type'] %>
        },
        "jobTypes": {
            "error-request": {
                "workerCount": <%= @node['activity_handler']['beanstalk']['jobTypes']['error-request']['worker_count'] %>
            },
            "activity-management-event": {
                "workerCount": <%= @node['activity_handler']['beanstalk']['jobTypes']['activity-management-event']['worker_count'] %>,
                "delay": <%= @node['activity_handler']['beanstalk']['jobTypes']['activity-management-event']['delay'] %>
            }
        },
        "handlerJobTypes": [
            "activity-management-event"
        ]
    },
    "jdsServer": {
        "baseUrl": "http://<%= @jds['ipaddress']%>:<%= @jds['jds']['cache_listener_ports']['general']%>",
        "timeout": 120000
    },
    "generalPurposeJdsServer": {
       "baseUrl": "http://<%= @pjds['ipaddress']%>:<%= @pjds['jds']['cache_listener_ports']['general']%>",
       "urlLengthLimit": 120
    },
    "vistaSites": {
        <% @vista_sites.each_with_index do |site, index| %>
        "<%= site['vista']['site_id']%>": {
            "division": <%= site['vista']['division'].to_json %>,
            "host": "<%= site['ipaddress']%>",
            "localIP": "IP      ",
            "localAddress": "localhost",
            "port": <%= site['vista']['rpc_port']%>,
            "production": <%= site['vista']['production']%>,
            "accessCode": "<%= site['vista']['access_code']%>",
            "verifyCode": "<%= site['vista']['verify_code']%>",
            "infoButtonOid": "1.3.6.1.4.1.3768",
            "abbreviation": "<%= site['vista']['abbreviation']%>"
        }<%= ',' unless index == @vista_sites.size - 1 %>
        <% end %>
    },
    <% if !@oracle.nil? %>
    "oracledb": {
        "activityDatabase": {
            "user": "<%= @oracle_ehmpuser_username %>",
            "password": "<%= @oracle_ehmpuser_password %>",
            "connectString": "<%= @oracle[:ipaddress] %>:<%= @oracle[:ehmp_oracle][:oracle_config][:port] %>/<%= @oracle[:ehmp_oracle][:oracle_sid] %>",
            "poolMin": <%= @node['activity_handler']['oracle_connection_pool']['minimum'] %>,
            "poolMax": <%= @node['activity_handler']['oracle_connection_pool']['maximum'] %>
        }
    },
    <% end %>
    <% if !@app_dynamics.nil? %>
    "appDynamicsProfile": {
        "controllerHostName": "<%= @app_dynamics['app_dynamics']['controller_host_name'] %>",
        "controllerPort": "<%= @app_dynamics['app_dynamics']['controller_port'] %>",
        "accountName": "<%= @app_dynamics['app_dynamics']['agent_account_name'] %>",
        "accountAccessKey": "<%= @app_dynamics['app_dynamics']['agent_account_access_key'] %>",
        "applicationName": "<%= @app_dynamics['app_dynamics']['agent_application_name'] %>",
        "tierName": "<%= @node['activity_handler']['app_dynamics']['agent_tier_name'] %>_<%= node['db_env']['activity_handler_env'].nil? ? 0 : node['db_env']['activity_handler_env']%>",
        "proxyAutolaunchDisabled": "<%= @node['app_dynamics']['proxy']['proxyAutolaunchDisabled'] %>",
        "proxyCtrlDir": "<%= @node['app_dynamics']['proxy']['ctl_dir']%>",
        "noNodeNameSuffix": "<%= @node['app_dynamics']['proxy']['noNodeNameSuffix'] %>"
    },
    <% end %>
    "jbpm": {
        "baseUrl": "http://<%= @jbpm_host %>",
        "apiPath": "/business-central/rest",
        "adminUser": {
            "username": "<%= @jbpm_admin_username %>",
            "password": "<%= @jbpm_admin_password %>"
        },
        "healthcheckEndpoint": "/deployment"
    },
    "activityManagementJobRetryLimit": <%= @node['activity_handler']['activityManagementJobRetryLimit'] %>,
    "defaultWorkerCount": <%= @node['activity_handler']['worker_count'] %>,
    "log-level": "<%= @node['activity_handler']['log_level']['activity_handler'] %>"
}
