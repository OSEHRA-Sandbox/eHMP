<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:cxf="http://cxf.apache.org/core"
       xmlns:jaxws="http://cxf.apache.org/jaxws"
       xmlns:jaxrs="http://cxf.apache.org/jaxrs"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="
			http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd
			http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
			http://cxf.apache.org/jaxrs http://cxf.apache.org/schemas/jaxrs.xsd
			http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd
			http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
			http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd">

    
     <context:annotation-config />

	<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="locations">
			<value>classpath:test.properties</value>
		</property>
	</bean>

     <bean id="mongoDbDao" class="com.cognitive.cds.invocation.mongo.MongoDbDao" >
		<property name="mongo_host" value="${mongo_host}" />
		<property name="mongo_port" value="${mongo_port}" />
		<property name="mongo_username" value="${mongo_username}" />
		<property name="mongo_password" value="${mongo_password}" />
		<property name="mongo_connectionsPerHost" value="${mongo_connectionsPerHost:10}" />
    </bean>
	<bean id="trustStore" class="org.springframework.core.io.ClassPathResource">
		<constructor-arg value="/certs/mongoStore.ts" />
	</bean>
	<util:property-path id="trustStoreFile" path="trustStore.URL" />
	
	<bean id="systemProps"
		class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetObject" value="#{@systemProperties}" />
    	   <property name="targetMethod" value="putAll" />
    	   <property name="arguments">
              <util:properties>
                 <prop key="javax.net.ssl.trustStorePassword">${trustStorePass}</prop>
                 <prop key="javax.net.ssl.trustStore">#{trustStore.file.path}</prop>
              </util:properties>
   	   </property>
	</bean>

    <bean id="engineInfoDao" class="com.cognitive.cds.invocation.mongo.EngineInfoDao">
        <property name="mongoDbDao" ref="mongoDbDao" />
    </bean>

	<bean id="intentLookup" class="com.cognitive.cds.invocation.mongo.IntentMappingDao">
		<property name="mongoDbDao" ref="mongoDbDao" />
		<property name="deployDefaultIntents" value="${deployDefaultIntents:true}" />
	</bean>
	
    <bean id="healthCheck" class="com.cognitive.cds.HealthCheck">
        <property name="mongoDb" ref="mongoDbDao" />
        <property name="engineInfoDao" ref="engineInfoDao" />
        <property name="intentLookup" ref="intentLookup" />
        <property name="crsServer" value="${CRSServer}" />
        <property name="rdkBaseURL" value="${RDK-resource-server}" />
        <property name="rdkAuthURL" value="${authentication-path}" />
    </bean>
		
</beans>
